<% admin_nav_crumbs admin_nav_books_link, admin_nav_book_link(@book), "AI Generated Summary" %>


<div class="row">
  <div class="col-md-6">
    <%= label_tag nil, "Summaries", class: "form-label" %>
    <div class="container b-generative-summaries" data-controller="book-generated-summaries">
      <% @summaries.each do |summary| %>
        <div class="row mb-2 b-summary border">
          <div class="col-md-12 p-3">
            <%= summary[:summary] %>
          </div>
          <div class="col-md-6">
            <div>Form: <%= summary[:form] %>.</div>
            <div>Genre: <%= summary[:genre] %>.</div>
            <div>Themes: <%= summary[:themes] %>.</div>
            <div><%= "Source: #{summary[:src]}" %></div>
          </div>
          <div class="col-md-6 text-end">
            <%= button_tag "Verify & Pick", class: "btn btn-primary btn-sm",
              data: { action: "click->book-generated-summaries#onPick",
                book_generated_summaries_summary_param: summary[:summary],
                book_generated_summaries_src_param: summary[:src],
                book_generated_summaries_genres_param: summary[:genre],
                book_generated_summaries_themes_param: summary[:themes],
                book_generated_summaries_form_param: summary[:form],
                book_generated_summaries_verification_url_param: verify_admin_book_generative_summary_path(@book, task_id: @task.id) } %>
          </div>
        </div>
      <% end %>

      <div class="mb-2">
        <%= button_to "Reject", reject_admin_book_generative_summary_path(@book, task_id: @task.id), method: :put,
          class: "btn btn-warning btn-sm", form: { class: "d-inline-block" } %>

        <% all_tags = @all_themes.join(",") %>
        <%= button_tag "Add all tags", class: "btn btn-primary btn-sm", title: all_tags,
          data: { action: "click->book-generated-summaries#onAddAllTags",
            book_generated_summaries_themes_param: all_tags } %>
      </div>
    </div>
  </div>

  <div class="container col-md-6">
    <%= label_tag nil, "Book form", class: "form-label" %>
    <%= render "admin/books/form", book: @book, old_book: @book, form_handler: @form %>
  </div>
</div>

